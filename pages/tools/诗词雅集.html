<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>诗词欣赏</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Noto Serif SC', serif; background-color: #fafafa; color: #444; line-height: 1.6; min-height: 100vh; display: flex; justify-content: center; align-items: center; padding: 20px; }
        .container { max-width: 800px; width: 100%; background: #ffffff; border-radius: 16px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.06); padding: 30px; text-align: center; transition: all 0.3s ease; position: relative; overflow: hidden; border: 1px solid #f0f0f0; }
        .poem-display { padding: 30px 25px; min-height: 300px; display: flex; flex-direction: column; justify-content: center; align-items: center; transition: opacity 0.4s ease; background: #f8f9fa; border-radius: 12px; margin-bottom: 25px; border: 1px solid #e9ecef; position: relative; }
        .poem-title { font-size: 1.5rem; font-weight: 600; margin-bottom: 10px; color: #5a67d8; }
        .poem-dynasty-author { font-size: 1rem; color: #718096; margin-bottom: 20px; font-style: italic; font-weight: 500; }
        .poem-content { font-size: 1.3rem; line-height: 1.8; margin-bottom: 20px; font-weight: 500; color: #2d3748; z-index: 1; position: relative; white-space: pre-line; }
        .poem-details { margin-top: 25px; padding-top: 20px; border-top: 1px solid #e9ecef; text-align: left; background: #ffffff; padding: 20px; border-radius: 8px; width: 100%; }
        .poem-details h4 { font-size: 1rem; color: #5a67d8; margin-top: 20px; margin-bottom: 10px; padding-bottom: 5px; border-bottom: 1px dashed #e9ecef; }
        .poem-details p { font-size: 0.9rem; color: #5a6c7d; line-height: 1.5; margin-bottom: 10px; }
        .audio-controls { display: flex; justify-content: center; gap: 15px; margin: 20px 0; }
        .audio-btn { background: #68d391; color: white; border: none; padding: 10px 18px; border-radius: 20px; cursor: pointer; font-size: 0.85rem; transition: all 0.3s ease; display: flex; align-items: center; gap: 5px; box-shadow: 0 4px 8px rgba(104, 211, 145, 0.2); }
        .audio-btn:hover { background: #48bb78; transform: translateY(-2px); box-shadow: 0 6px 12px rgba(104, 211, 145, 0.3); }
        .interpretation-item { margin-bottom: 12px; padding-bottom: 10px; border-bottom: 1px dashed #e9ecef; }
        .interpretation-body { font-weight: 500; color: #2d3748; }
        .interpretation-pinyin { color: #5a67d8; font-size: 0.85rem; }
        .interpretation-translate { color: #718096; }
        .api-selector { display: flex; flex-direction: column; align-items: center; gap: 15px; margin-bottom: 20px; }
        .select-wrapper { position: relative; width: 240px; }
        .api-select { width: 100%; padding: 12px 16px; border: 1px solid #e9ecef; border-radius: 8px; background-color: white; font-family: inherit; font-size: 0.9rem; color: #2d3748; cursor: pointer; appearance: none; -webkit-appearance: none; -moz-appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%235a67d8' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: calc(100% - 12px) center; padding-right: 40px; transition: all 0.2s ease; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05); }
        .api-select:focus { outline: none; box-shadow: 0 0 0 2px rgba(90, 103, 216, 0.2); border-color: #5a67d8; }
        .random-api-selector, .weather-type-selector, .poem-search-input { display: none; margin: 15px 0 20px; transition: all 0.3s ease; }
        .random-api-selector.show, .weather-type-selector.show, .poem-search-input.show { display: flex; justify-content: center; gap: 8px; flex-wrap: wrap; }
        .random-api-btn, .weather-type-btn { background: transparent; border: 1px solid #e9ecef; color: #5a6c7d; padding: 8px 14px; border-radius: 16px; cursor: pointer; font-size: 0.8rem; transition: all 0.2s ease; font-family: inherit; font-weight: 400; }
        .random-api-btn.active, .weather-type-btn.active { background: #5a67d8; color: white; border-color: #5a67d8; box-shadow: 0 2px 5px rgba(90, 103, 216, 0.3); }
        .random-api-btn:hover:not(.active), .weather-type-btn:hover:not(.active) { background: rgba(90, 103, 216, 0.05); transform: translateY(-1px); }
        .search-input { padding: 12px 16px; border: 1px solid #e9ecef; border-radius: 8px; font-family: inherit; font-size: 0.9rem; color: #2d3748; width: 200px; transition: all 0.2s ease; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05); }
        .search-input:focus { outline: none; box-shadow: 0 0 0 2px rgba(90, 103, 216, 0.2); border-color: #5a67d8; }
        .get-btn { background: #5a67d8; color: white; border: none; padding: 12px 28px; border-radius: 20px; cursor: pointer; font-size: 0.9rem; transition: all 0.3s ease; font-family: inherit; font-weight: 500; display: inline-flex; align-items: center; gap: 8px; box-shadow: 0 4px 8px rgba(90, 103, 216, 0.2); }
        .get-btn:hover { background: #4c51bf; transform: translateY(-2px); box-shadow: 0 6px 12px rgba(90, 103, 216, 0.3); }
        .get-btn:active { transform: translateY(0); }
        .loading { color: #5a67d8; font-style: italic; margin-top: 15px; opacity: 0.8; display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 0.85rem; }
        .loading i { animation: spin 1.5s linear infinite; color: #5a67d8; }
        .error { color: #e53e3e; background: rgba(229, 62, 62, 0.05); padding: 10px 15px; border-radius: 6px; margin-top: 15px; display: inline-flex; align-items: center; gap: 6px; border-left: 2px solid #e53e3e; font-size: 0.85rem; }
        .fade-in { animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @media (max-width: 600px) {
            .container { padding: 25px 20px; }
            .poem-content { font-size: 1.15rem; }
            .api-selector { gap: 12px; }
            .select-wrapper { width: 100%; max-width: 220px; }
            .search-input { width: 180px; }
            .get-btn { width: 90%; justify-content: center; }
            .random-api-selector, .weather-type-selector { gap: 6px; }
            .random-api-btn, .weather-type-btn { padding: 6px 12px; font-size: 0.75rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="poemDisplay" class="poem-display fade-in">
            <div class="poem-title">《静夜思》</div>
            <div class="poem-dynasty-author">唐—— 李白</div>
            <div class="poem-content">床前明月光，疑是地上霜。
举头望明月，低头思故乡。</div>
            
            <div class="poem-details">
                <div class="audio-controls">
                    <button class="audio-btn"><i class="fas fa-volume-up"></i> 女声</button>
                    <button class="audio-btn"><i class="fas fa-volume-up"></i> 男声</button>
                </div>
                
                <h4>全部释义</h4>
                <p>明亮的月光洒在窗户纸上，好像地上泛起了一层霜。我禁不住抬起头来，看那天窗外空中的一轮明月，不由得低头沉思，想起远方的家乡。</p>
                
                <h4>逐句释义</h4>
                <div class="interpretation-item">
                    <div class="interpretation-body">床前明月光</div>
                    <div class="interpretation-pinyin">chuáng qián míng yuè guāng</div>
                    <div class="interpretation-translate">明亮的月光洒在窗户纸上</div>
                </div>
                <div class="interpretation-item">
                    <div class="interpretation-body">疑是地上霜</div>
                    <div class="interpretation-pinyin">yí shì dì shàng shuāng</div>
                    <div class="interpretation-translate">好像地上泛起了一层霜</div>
                </div>
                <div class="interpretation-item">
                    <div class="interpretation-body">举头望明月</div>
                    <div class="interpretation-pinyin">jǔ tóu wàng míng yuè</div>
                    <div class="interpretation-translate">我禁不住抬起头来</div>
                </div>
                <div class="interpretation-item">
                    <div class="interpretation-body">低头思故乡</div>
                    <div class="interpretation-pinyin">dī tóu sī gù xiāng</div>
                    <div class="interpretation-translate">看那天窗外空中的一轮明月，不由得低头沉思，想起远方的家乡</div>
                </div>
                
                <h4>词语解释</h4>
                <p><strong>静夜思</strong>：宁静的夜晚产生的思绪</p>
                <p><strong>疑</strong>：怀疑，以为</p>
                <p><strong>举头</strong>：抬头</p>
            </div>
        </div>
        
        <div class="api-selector">
            <div class="select-wrapper">
                <select id="apiSelect" class="api-select">
                    <option value="api1">随机诗词</option>
                    <option value="api4">每日诗词</option>
                    <option value="api5">优美诗句</option>
                    <option value="api6">唐诗大全</option>
                    <option value="api7">天气诗句</option>
                    <option value="api8">诗词全文搜索</option>
                    <option value="api2">经典古诗</option>
                    <option value="api3">诗经精选</option>
                </select>
            </div>
        </div>
        
        <div id="randomApiSelector" class="random-api-selector">
            <button class="random-api-btn active" data-random-api="api1a">随机诗词源A</button>
            <button class="random-api-btn" data-random-api="api1b">随机诗词源B</button>
            <button class="random-api-btn" data-random-api="api1c">随机诗词源C</button>
        </div>
        
        <div id="weatherTypeSelector" class="weather-type-selector">
            <button class="weather-type-btn active" data-weather-type="0">随机天气</button>
            <button class="weather-type-btn" data-weather-type="1">风</button>
            <button class="weather-type-btn" data-weather-type="2">云</button>
            <button class="weather-type-btn" data-weather-type="3">雨</button>
            <button class="weather-type-btn" data-weather-type="4">雪</button>
            <button class="weather-type-btn" data-weather-type="5">霜</button>
            <button class="weather-type-btn" data-weather-type="6">露</button>
            <button class="weather-type-btn" data-weather-type="7">雾</button>
            <button class="weather-type-btn" data-weather-type="8">雷</button>
            <button class="weather-type-btn" data-weather-type="9">晴</button>
            <button class="weather-type-btn" data-weather-type="10">阴</button>
        </div>
        
        <div id="poemSearchInput" class="poem-search-input">
            <input type="text" id="poemKeyword" class="search-input" placeholder="输入诗词名，如：赠汪伦">
        </div>
        
        <div class="controls">
            <button class="get-btn"><i class="fas fa-sync-alt"></i> 获取新诗词</button>
        </div>
        
        <div id="status"></div>
    </div>

    <script>
        let currentApi = 'api1';
        let currentRandomApi = 'api1a';
        let currentWeatherType = '0';
        let currentPoemKeyword = '';
        
        document.addEventListener('DOMContentLoaded', function() {
            const apiSelect = document.getElementById('apiSelect');
            const randomApiBtns = document.querySelectorAll('.random-api-btn');
            const weatherTypeBtns = document.querySelectorAll('.weather-type-btn');
            const getBtn = document.querySelector('.get-btn');
            const randomApiSelector = document.getElementById('randomApiSelector');
            const weatherTypeSelector = document.getElementById('weatherTypeSelector');
            const poemSearchInput = document.getElementById('poemSearchInput');
            const poemKeyword = document.getElementById('poemKeyword');
            
            apiSelect.addEventListener('change', function() {
                currentApi = this.value;
                
                if (currentApi === 'api1') {
                    randomApiSelector.classList.add('show');
                    weatherTypeSelector.classList.remove('show');
                    poemSearchInput.classList.remove('show');
                } else {
                    randomApiSelector.classList.remove('show');
                }
                
                if (currentApi === 'api7') {
                    weatherTypeSelector.classList.add('show');
                    poemSearchInput.classList.remove('show');
                } else {
                    weatherTypeSelector.classList.remove('show');
                }
                
                if (currentApi === 'api8') {
                    poemSearchInput.classList.add('show');
                } else {
                    poemSearchInput.classList.remove('show');
                }
                
                getPoem();
            });
            
            randomApiBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    randomApiBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentRandomApi = this.getAttribute('data-random-api');
                    getPoem();
                });
            });
            
            weatherTypeBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    weatherTypeBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentWeatherType = this.getAttribute('data-weather-type');
                    getPoem();
                });
            });
            
            poemKeyword.addEventListener('input', function() {
                currentPoemKeyword = this.value.trim();
            });
            
            getBtn.addEventListener('click', getPoem);
            
            getPoem();
        });
        
        function cleanText(text) {
            return text.replace(/[━─┄┅]+/g, '')
                      .replace(/\s+/g, ' ')
                      .trim();
        }
        
        function processShijingText(text) {
            const match = text.match(/《([^》]+)》(.+)/s);
            
            if (match) {
                const title = match[1];
                let content = match[2];
                
                content = content.replace(/\\n/g, ' ').replace(/\n/g, ' ').trim();
                
                return {
                    title: title,
                    content: content,
                    author: '诗经',
                    works: title
                };
            } else {
                return {
                    title: '',
                    content: text.replace(/\\n/g, ' ').replace(/\n/g, ' ').trim(),
                    author: '诗经',
                    works: ''
                };
            }
        }
        
        function processBackupApiText(text) {
            const contentMatch = text.match(/(.+)(——|--)(.+)/);
            
            if (contentMatch) {
                let content = contentMatch[1].trim();
                let authorInfo = contentMatch[3].trim();
                
                const authorMatch = authorInfo.match(/(.+?)《(.+?)》/);
                
                if (authorMatch) {
                    return {
                        content: content,
                        author: authorMatch[1].trim(),
                        works: authorMatch[2].trim()
                    };
                } else {
                    return {
                        content: content,
                        author: authorInfo,
                        works: ''
                    };
                }
            } else {
                return {
                    content: text,
                    author: '',
                    works: ''
                };
            }
        }
        
        function processRandomApiC(jsonData) {
            if (jsonData.code === 200 && jsonData.text) {
                return processBackupApiText(jsonData.text);
            } else {
                throw new Error('API返回数据格式异常');
            }
        }
        
        function processDailyPoem(jsonData) {
            if (jsonData.status === 'success' && jsonData.data) {
                const data = jsonData.data;
                return {
                    content: data.content,
                    author: data.origin.author,
                    works: data.origin.title
                };
            } else {
                throw new Error('API返回数据格式异常');
            }
        }
        
        function processVerseApi(jsonData) {
            if (jsonData.code === 200 && jsonData.result && jsonData.result.list && jsonData.result.list.length > 0) {
                const data = jsonData.result.list[0];
                return {
                    content: data.content,
                    author: data.author,
                    works: data.source
                };
            } else {
                throw new Error('API返回数据格式异常');
            }
        }
        
        function processPoetriesApi(jsonData) {
            if (jsonData.code === 200 && jsonData.result && jsonData.result.list && jsonData.result.list.length > 0) {
                const data = jsonData.result.list[0];
                return {
                    content: data.content,
                    author: data.author,
                    works: data.title
                };
            } else {
                throw new Error('API返回数据格式异常');
            }
        }
        
        function processWeatherVerseApi(jsonData) {
            if (jsonData.code === 200 && jsonData.result) {
                const data = jsonData.result;
                const weatherTypes = {
                    1: '风', 2: '云', 3: '雨', 4: '雪', 5: '霜',
                    6: '露', 7: '雾', 8: '雷', 9: '晴', 10: '阴'
                };
                
                const weatherTypeName = weatherTypes[data.tqtype] || '未知天气';
                
                return {
                    content: data.content,
                    author: data.author,
                    works: data.source,
                    weatherType: weatherTypeName
                };
            } else {
                throw new Error('API返回数据格式异常');
            }
        }
        
        function processPoemSearchApi(jsonData) {
            if (jsonData.code === 200) {
                const tags = jsonData.tags ? jsonData.tags.join('、') : '';
                
                return {
                    content: jsonData.content,
                    author: jsonData.author ? jsonData.author.name : '',
                    works: jsonData.title,
                    dynasty: jsonData.dynasty,
                    tags: tags,
                    voice: jsonData.voice,
                    notes: jsonData.notes,
                    shiju_interpretation: jsonData.shiju_interpretation,
                    ciyu_explanation: jsonData.ciyu_explanation
                };
            } else {
                throw new Error('未找到相关诗词');
            }
        }
        
        function playAudio(audioUrl) {
            const audio = new Audio(audioUrl);
            audio.play().catch(e => {
                console.error('音频播放失败:', e);
                alert('音频播放失败，请检查网络连接或浏览器设置');
            });
        }
        
        async function getPoem() {
            const display = document.getElementById('poemDisplay');
            const status = document.getElementById('status');
            
            status.innerHTML = '<div class="loading"><i class="fas fa-spinner"></i> 正在获取诗词...</div>';
            
            display.style.opacity = '0.5';
            
            try {
                let poemData;
                
                if (currentApi === 'api1') {
                    if (currentRandomApi === 'api1a') {
                        try {
                            const response = await fetch('https://api.lbbb.cc/api/shici', {
                                method: 'GET',
                                headers: {
                                    'Accept': 'text/plain'
                                },
                                mode: 'cors'
                            });
                            
                            if (!response.ok) {
                                throw new Error(`HTTP错误! 状态: ${response.status}`);
                            }
                            
                            const poemText = await response.text();
                            const cleanedText = cleanText(poemText);
                            poemData = {
                                content: cleanedText,
                                author: '',
                                works: ''
                            };
                        } catch (error) {
                            console.error('第一个随机诗词API失败:', error);
                            throw new Error('随机诗词源A获取失败，请重试');
                        }
                    } else if (currentRandomApi === 'api1b') {
                        try {
                            const backupResponse = await fetch('https://api.niniandmiaomiao.love/api/xb/api/sc.php', {
                                method: 'GET',
                                mode: 'cors'
                            });
                            
                            if (!backupResponse.ok) {
                                throw new Error(`HTTP错误! 状态: ${backupResponse.status}`);
                            }
                            
                            const textData = await backupResponse.text();
                            console.log('API返回的原始数据:', textData);
                            poemData = processBackupApiText(textData);
                        } catch (error) {
                            console.error('第二个随机诗词API失败:', error);
                            throw new Error('随机诗词源B获取失败，请重试');
                        }
                    } else if (currentRandomApi === 'api1c') {
                        try {
                            const response = await fetch('https://api.qster.top/API/v1/randpo/?qskey=qstertop&type=json', {
                                method: 'GET',
                                mode: 'cors'
                            });
                            
                            if (!response.ok) {
                                throw new Error(`HTTP错误! 状态: ${response.status}`);
                            }
                            
                            const jsonData = await response.json();
                            console.log('API源C返回的原始数据:', jsonData);
                            poemData = processRandomApiC(jsonData);
                        } catch (error) {
                            console.error('第三个随机诗词API失败:', error);
                            throw new Error('随机诗词源C获取失败，请重试');
                        }
                    }
                } else if (currentApi === 'api2') {
                    const response = await fetch('https://api.qhsou.com/api/gsc.php', {
                        method: 'GET',
                        mode: 'cors'
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP错误! 状态: ${response.status}`);
                    }
                    
                    const jsonData = await response.json();
                    
                    if (jsonData.status !== 'success') {
                        throw new Error('API返回状态异常');
                    }
                    
                    poemData = {
                        content: jsonData.data.content,
                        author: jsonData.data.author,
                        works: jsonData.data.works
                    };
                } else if (currentApi === 'api3') {
                    const response = await fetch('https://api.niniandmiaomiao.love/api/xb/api/shijing.php', {
                        method: 'GET',
                        mode: 'cors'
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP错误! 状态: ${response.status}`);
                    }
                    
                    const poemText = await response.text();
                    poemData = processShijingText(poemText);
                } else if (currentApi === 'api4') {
                    const response = await fetch('https://whyta.cn/api/shici?key=738b541a5f7a', {
                        method: 'GET',
                        mode: 'cors'
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP错误! 状态: ${response.status}`);
                    }
                    
                    const jsonData = await response.json();
                    console.log('每日诗词API返回的原始数据:', jsonData);
                    poemData = processDailyPoem(jsonData);
                } else if (currentApi === 'api5') {
                    const response = await fetch('https://whyta.cn/api/tx/verse?key=738b541a5f7a&num=1', {
                        method: 'GET',
                        mode: 'cors'
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP错误! 状态: ${response.status}`);
                    }
                    
                    const jsonData = await response.json();
                    console.log('优美诗句API返回的原始数据:', jsonData);
                    poemData = processVerseApi(jsonData);
                } else if (currentApi === 'api6') {
                    const response = await fetch('https://whyta.cn/api/tx/poetries?key=738b541a5f7a&num=1&page=1&rand=1', {
                        method: 'GET',
                        mode: 'cors'
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP错误! 状态: ${response.status}`);
                    }
                    
                    const jsonData = await response.json();
                    console.log('唐诗大全API返回的原始数据:', jsonData);
                    poemData = processPoetriesApi(jsonData);
                } else if (currentApi === 'api7') {
                    let apiUrl = 'https://whyta.cn/api/tx/tianqishiju?key=738b541a5f7a';
                    
                    if (currentWeatherType !== '0') {
                        apiUrl += `&tqtype=${currentWeatherType}`;
                    }
                    
                    const response = await fetch(apiUrl, {
                        method: 'GET',
                        mode: 'cors'
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP错误! 状态: ${response.status}`);
                    }
                    
                    const jsonData = await response.json();
                    console.log('天气诗句API返回的原始数据:', jsonData);
                    poemData = processWeatherVerseApi(jsonData);
                } else if (currentApi === 'api8') {
                    if (!currentPoemKeyword) {
                        throw new Error('请输入诗词名称进行搜索');
                    }
                    
                    const apiUrl = `https://api.suol.cc/v1/shici.php?msg=${encodeURIComponent(currentPoemKeyword)}&n=1`;
                    
                    const response = await fetch(apiUrl, {
                        method: 'GET',
                        mode: 'cors'
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP错误! 状态: ${response.status}`);
                    }
                    
                    const jsonData = await response.json();
                    console.log('诗词全文搜索API返回的原始数据:', jsonData);
                    poemData = processPoemSearchApi(jsonData);
                }
                
                let poemHTML = '';
                
                if (currentApi === 'api8' && poemData.works) {
                    poemHTML += `<div class="poem-title">《${poemData.works}》</div>`;
                    
                    if (poemData.dynasty && poemData.author) {
                        poemHTML += `<div class="poem-dynasty-author">${poemData.dynasty}—— ${poemData.author}</div>`;
                    }
                    
                    poemHTML += `<div class="poem-content">${poemData.content}</div>`;
                    
                    if (poemData.voice || poemData.notes || poemData.shiju_interpretation || poemData.ciyu_explanation) {
                        poemHTML += `<div>`;
                        
                        if (poemData.voice) {
                            poemHTML += `<div class="audio-controls">`;
                            if (poemData.voice.woman) {
                                poemHTML += `<button class="audio-btn" onclick="playAudio('${poemData.voice.woman}')"><i class="fas fa-volume-up"></i> 女声</button>`;
                            }
                            if (poemData.voice.man) {
                                poemHTML += `<button class="audio-btn" onclick="playAudio('${poemData.voice.man}')"><i class="fas fa-volume-up"></i> 男声</button>`;
                            }
                            poemHTML += `</div>`;
                        }
                        
                        if (poemData.notes) {
                            poemHTML += `<h4>全部释义</h4><p>${poemData.notes}</p>`;
                        }
                        
                        if (poemData.shiju_interpretation && poemData.shiju_interpretation.length > 0) {
                            poemHTML += `<h4>逐句释义</h4>`;
                            poemData.shiju_interpretation.forEach(item => {
                                poemHTML += `
                                    <div class="interpretation-item">
                                        <div class="interpretation-body">${item.body}</div>
                                        <div class="interpretation-pinyin">${item.pinyin}</div>
                                        <div class="interpretation-translate">${item.translate}</div>
                                    </div>
                                `;
                            });
                        }
                        
                        if (poemData.ciyu_explanation && poemData.ciyu_explanation.length > 0) {
                            poemHTML += `<h4>词语解释</h4>`;
                            poemData.ciyu_explanation.forEach(item => {
                                poemHTML += `<p><strong>${item.source}</strong>：${item.zhushi}</p>`;
                            });
                        }
                        
                        poemHTML += `</div>`;
                    }
                } else {
                    poemHTML = `<div class="poem-content">${poemData.content}</div>`;
                    
                    if (poemData.author) {
                        poemHTML += `<div class="poem-author">—— ${poemData.author}</div>`;
                    }
                    
                    if (poemData.works) {
                        poemHTML += `<div class="poem-works">《${poemData.works}》</div>`;
                    }
                    
                    if (poemData.weatherType) {
                        poemHTML += `<div class="poem-weather-type">${poemData.weatherType}相关诗句</div>`;
                    }
                }
                
                display.innerHTML = poemHTML;
                display.classList.add('fade-in');
                
                display.style.opacity = '1';
                
                setTimeout(() => {
                    status.innerHTML = '';
                }, 1500);
                
            } catch (error) {
                console.error('获取诗词失败:', error);
                status.innerHTML = `<div class="error"><i class="fas fa-exclamation-circle"></i> 获取失败: ${error.message}</div>`;
                
                display.style.opacity = '1';
                
                setTimeout(() => {
                    status.innerHTML = '';
                }, 3000);
            }
        }
    </script>
</body>
</html>