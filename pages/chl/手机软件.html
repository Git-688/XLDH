<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>软件下载中心</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <style type="text/tailwindcss">
        @layer utilities {
            .app-card {
                @apply bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden flex items-center;
            }
            .app-icon {
                @apply w-10 h-10 rounded object-cover bg-white border border-gray-200;
            }
            .download-btn {
                @apply bg-green-600 text-white w-8 h-8 rounded-full flex items-center justify-center hover:bg-green-700 transition-colors;
            }
            .back-btn {
                @apply bg-gray-200 text-gray-800 w-8 h-8 rounded-full flex items-center justify-center hover:bg-gray-300 transition-colors;
            }
            .search-input {
                @apply w-full text-xs px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-gray-500;
            }
            .tag-btn {
                @apply text-xs px-2 py-1 rounded-md border border-gray-300 hover:bg-gray-100 transition-colors;
            }
            .tag-btn.active {
                @apply bg-gray-800 text-white border-gray-800;
            }
            .app-tag {
                @apply text-[10px] px-1.5 py-0.5 rounded text-white ml-1.5 font-medium;
            }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 text-xs flex flex-col h-screen">
    <!-- 固定头部区域 -->
    <div class="bg-gray-50 border-b border-gray-200 sticky top-0 z-10">
        <div class="container mx-auto px-3 pt-4 pb-3 max-w-4xl">
            <!-- 页面标题和副标题 -->
            <div class="text-center mb-4">
                <h1 class="text-base font-semibold">软件下载中心</h1>
                <p class="text-gray-500 text-xs mt-1">更多应用正在持续更新中..</p>
            </div>
            
            <!-- 搜索框 -->
            <div class="mb-3">
                <input type="text" id="searchInput" class="search-input" placeholder="搜索软件名称...">
            </div>
            
            <!-- 标签分类栏 -->
            <div class="overflow-x-auto">
                <div class="flex gap-2 min-w-max">
                    <button id="allTag" class="tag-btn active">全部</button>
                    <div id="tagList"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 可滚动的软件列表区域 -->
    <div class="flex-1 overflow-auto">
        <div class="container mx-auto px-3 py-3 max-w-4xl">
            <div id="appList" class="grid grid-cols-1 gap-2">
                <!-- 软件卡片将通过JS动态渲染 -->
            </div>
        </div>
    </div>

    <!-- 引入外部数据文件 -->
    <script src="rjxz.js"></script>
    
    <script>
        // 全局状态
        let currentTag = "all";
        let currentKeyword = "";

        // 渲染标签栏
        const renderTags = () => {
            const tagList = document.getElementById('tagList');
            tagList.innerHTML = allTags.map(tag => `
                <button class="tag-btn" data-tag="${tag}">${tag}</button>
            `).join('');

            // 标签点击事件
            document.querySelectorAll('.tag-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.tag-btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    currentTag = e.target.dataset.tag || "all";
                    filterAndRenderApps();
                });
            });
            
            // "全部"按钮点击事件
            document.getElementById('allTag').addEventListener('click', (e) => {
                document.querySelectorAll('.tag-btn').forEach(b => b.classList.remove('active'));
                e.target.classList.add('active');
                currentTag = "all";
                filterAndRenderApps();
            });
        };

        // 筛选与渲染软件列表
        const filterAndRenderApps = () => {
            const filteredApps = appData.filter(app => {
                const tagMatch = currentTag === "all" || app.tag === currentTag;
                const keywordMatch = app.name.toLowerCase().includes(currentKeyword) || 
                                     app.desc.toLowerCase().includes(currentKeyword);
                return tagMatch && keywordMatch;
            });

            const appList = document.getElementById('appList');
            appList.innerHTML = filteredApps.map(app => {
                const tagColor = tagColorMap[app.tag] || "bg-gray-700";
                return `
                    <div class="app-card p-3 gap-3 w-full">
                        <img src="${app.icon}" alt="${app.name}" class="app-icon shrink-0">
                        <div class="flex-1 min-w-0">
                            <div class="flex flex-wrap items-center mb-0.5">
                                <h3 class="font-medium">${app.name}</h3>
                                <span class="app-tag ${tagColor}">${app.tag}</span>
                            </div>
                            <p class="text-gray-500 line-clamp-1">${app.desc}</p>
                        </div>
                        <a href="${app.url}" class="download-btn shrink-0" target="_blank" title="下载">
                            <i class="fa fa-download text-xs"></i>
                        </a>
                    </div>
                `;
            }).join('');

            if (filteredApps.length === 0) {
                appList.innerHTML = '<div class="text-center py-4 text-gray-500">未找到匹配的软件</div>';
            }
        };

        // 初始化搜索功能
        const initSearch = () => {
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', (e) => {
                currentKeyword = e.target.value.trim().toLowerCase();
                filterAndRenderApps();
            });
        };

        // 初始化页面
        document.addEventListener('DOMContentLoaded', () => {
            renderTags();
            initSearch();
            filterAndRenderApps();
        });
    </script>
</body>
</html>